# Import packages for data manipulation
import numpy as np
import pandas as pd

# Import packages for data visualization
import seaborn as sns
import matplotlib.pyplot as plt

# Import packages for statistical analysis/hypothesis testing
from scipy import stats

# Load dataset into dataframe
data = pd.read_csv("tiktok_dataset.csv")

# Display first few rows
data.head()

# Check for missing values
data.isna().sum()

# Drop rows with missing values
data = data.dropna()

# Compute the mean `video_view_count` for each group in `verified_status`
data.groupby(['verified_status']).mean()[['video_view_count']]

# Null hypothesis: There is no difference in the mean number of views between videos posted by verified accounts versus unverified accounts (any observed difference in the sample data is due to chance or sampling variability).
# Alternate hypothesis: There is a statistical difference in the mean number of views between videos posted by verified accounts versus unverified accounts (any observed difference in the sample data is due to an actual difference in the corresponding population means).

# Significance level: 5%

# Conduct a two-sample t-test to compare means
verified = data[data['verified_status'] == 'verified']['video_view_count']
not_verified = data[data['verified_status'] == 'not verified']['video_view_count']
stats.ttest_ind(a = verified, b = not_verified, equal_var = False)
# Since the p-value is much smaller than the significance level of 5%, we reject the null hypothesis. There is a statistically significant difference in the mean number of views between videos posted by verified accounts versus unverified accounts.
# This suggests there might be fundamental behavioural differences between these two groups of accounts and would be interesting to investigate the root cause of this.
# We should build a regression model for verified_status next to help analyze user behavior in the different groups of users.
